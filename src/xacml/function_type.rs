use super::*;
use crate::utils::*;
use function_implementation::*;

/// 5.28 FunctionType definition
/// Used to name a function in the ApplyType
#[derive(Serialize, Deserialize, PartialEq, Eq, Debug, Builder)]
#[builder(pattern = "owned", setter(into, strip_option))]
pub struct FunctionType {
    #[serde(rename = "@FunctionId")]
    function_id: FunctionId,   
}  


impl FunctionId {
    /// Evaluate the function
    pub (super) fn apply_function(&self, parameters: Vec<&Value>) -> Result<Vec<Value>, XacmlError> {
        match self {
            FunctionId::StringEqual => return string_equal(&parameters),
            FunctionId::BooleanEqual => return boolean_equal(&parameters),
            FunctionId::IntegerEqual => return integer_equal(&parameters),
            FunctionId::DoubleEqual => return double_equal(&parameters),
            FunctionId::AnyURIEqual => return any_uri_equal(&parameters),
            FunctionId::IntegerAdd => return integer_add(&parameters),
            FunctionId::DoubleAdd => return double_add(&parameters),
            FunctionId::DoubleSubtract => return double_subtract(&parameters),
            FunctionId::DoubleMultiply => return double_multiply(&parameters),
            FunctionId::DoubleDivide => return double_divide(&parameters),
            FunctionId::DoubleGreaterThan => return double_greater_than(&parameters),
            FunctionId::DoubleGreaterThanOrEqual => double_greater_than_or_equal(&parameters),
            _ => return Err(XacmlError::new(XacmlErrorType::NotImplemented,  format!("Function {:?} not implemented", self)))
        }
    }
}


// Generated by helper/function-ids/script.py
// refactoring necessary: use constant mapping for better maintainability
#[allow(dead_code)] 
// During development it does not make sense to have dead code warngings here
#[derive(Debug, PartialEq, Eq)]
pub enum FunctionId {
    StringEqual,
    BooleanEqual,
    IntegerEqual,
    DoubleEqual,
    DateEqual,
    TimeEqual,
    DateTimeEqual,
    DayTimeDurationEqual,
    YearMonthDurationEqual,
    StringEqualIgnoreCase,
    AnyURIEqual,
    X500NameEqual,
    Rfc822NameEqual,
    HexBinaryEqual,
    Base64BinaryEqual,
    IntegerAdd,
    DoubleAdd,
    IntegerSubtract,
    DoubleSubtract,
    IntegerMultiply,
    DoubleMultiply,
    IntegerDivide,
    DoubleDivide,
    IntegerMod,
    IntegerAbs,
    DoubleAbs,
    Round,
    Floor,
    StringNormalizeSpace,
    StringNormalizeToLowerCase,
    DoubleToInteger,
    IntegerToDouble,
    Or,
    And,
    NOf,
    Not,
    IntegerGreaterThan,
    IntegerGreaterThanOrEqual,
    IntegerLessThan,
    IntegerLessThanOrEqual,
    DoubleGreaterThan,
    DoubleGreaterThanOrEqual,
    DoubleLessThan,
    DoubleLessThanOrEqual,
    DateTimeAddDayTimeDuration,
    DateTimeAddYearMonthDuration,
    DateTimeSubtractDayTimeDuration,
    DateTimeSubtractYearMonthDuration,
    DateAddYearMonthDuration,
    DateSubtractYearMonthDuration,
    StringGreaterThan,
    StringGreaterThanOrEqual,
    StringLessThan,
    StringLessThanOrEqual,
    TimeGreaterThan,
    TimeGreaterThanOrEqual,
    TimeLessThan,
    TimeLessThanOrEqual,
    TimeInRange,
    DateTimeGreaterThan,
    DateTimeGreaterThanOrEqual,
    DateTimeLessThan,
    DateTimeLessThanOrEqual,
    DateGreaterThan,
    DateGreaterThanOrEqual,
    DateLessThan,
    DateLessThanOrEqual,
    StringOneAndOnly,
    StringBagSize,
    StringIsIn,
    StringBag,
    BooleanOneAndOnly,
    BooleanBagSize,
    BooleanIsIn,
    BooleanBag,
    IntegerOneAndOnly,
    IntegerBagSize,
    IntegerIsIn,
    IntegerBag,
    DoubleOneAndOnly,
    DoubleBagSize,
    DoubleIsIn,
    DoubleBag,
    TimeOneAndOnly,
    TimeBagSize,
    TimeIsIn,
    TimeBag,
    DateOneAndOnly,
    DateBagSize,
    DateIsIn,
    DateBag,
    DateTimeOneAndOnly,
    DateTimeBagSize,
    DateTimeIsIn,
    DateTimeBag,
    AnyURIOneAndOnly,
    AnyURIBagSize,
    AnyURIIsIn,
    AnyURIBag,
    HexBinaryOneAndOnly,
    HexBinaryBagSize,
    HexBinaryIsIn,
    HexBinaryBag,
    Base64BinaryOneAndOnly,
    Base64BinaryBagSize,
    Base64BinaryIsIn,
    Base64BinaryBag,
    DayTimeDurationOneAndOnly,
    DayTimeDurationBagSize,
    DayTimeDurationIsIn,
    DayTimeDurationBag,
    YearMonthDurationOneAndOnly,
    YearMonthDurationBagSize,
    YearMonthDurationIsIn,
    YearMonthDurationBag,
    X500NameOneAndOnly,
    X500NameBagSize,
    X500NameIsIn,
    X500NameBag,
    Rfc822NameOneAndOnly,
    Rfc822NameBagSize,
    Rfc822NameIsIn,
    Rfc822NameBag,
    IpAddressOneAndOnly,
    IpAddressBagSize,
    IpAddressBag,
    DnsNameOneAndOnly,
    DnsNameBagSize,
    DnsNameBag,
    StringConcatenate,
    BooleanFromString,
    StringFromBoolean,
    IntegerFromString,
    StringFromInteger,
    DoubleFromString,
    StringFromDouble,
    TimeFromString,
    StringFromTime,
    DateFromString,
    StringFromDate,
    DateTimeFromString,
    StringFromDateTime,
    AnyURIFromString,
    StringFromAnyURI,
    DayTimeDurationFromString,
    StringFromDayTimeDuration,
    YearMonthDurationFromString,
    StringFromYearMonthDuration,
    X500NameFromString,
    StringFromX500Name,
    Rfc822NameFromString,
    StringFromRfc822Name,
    IpAddressFromString,
    StringFromIpAddress,
    DnsNameFromString,
    StringFromDnsName,
    StringStartsWith,
    AnyURIStartsWith,
    StringEndsWith,
    AnyURIEndsWith,
    StringContains,
    AnyURIContains,
    StringSubstring,
    AnyURISubstring,
    AnyOf,
    AllOf,
    AnyOfAny,
    AllOfAny,
    AnyOfAll,
    AllOfAll,
    Map,
    X500NameMatch,
    Rfc822NameMatch,
    StringRegexpMatch,
    AnyURIRegexpMatch,
    IpAddressRegexpMatch,
    DnsNameRegexpMatch,
    Rfc822NameRegexpMatch,
    X500NameRegexpMatch,
    XpathNodeCount,
    XpathNodeEqual,
    XpathNodeMatch,
    StringIntersection,
    StringAtLeastOneMemberOf,
    StringUnion,
    StringSubset,
    StringSetEquals,
    BooleanIntersection,
    BooleanAtLeastOneMemberOf,
    BooleanUnion,
    BooleanSubset,
    BooleanSetEquals,
    IntegerIntersection,
    IntegerAtLeastOneMemberOf,
    IntegerUnion,
    IntegerSubset,
    IntegerSetEquals,
    DoubleIntersection,
    DoubleAtLeastOneMemberOf,
    DoubleUnion,
    DoubleSubset,
    DoubleSetEquals,
    TimeIntersection,
    TimeAtLeastOneMemberOf,
    TimeUnion,
    TimeSubset,
    TimeSetEquals,
    DateIntersection,
    DateAtLeastOneMemberOf,
    DateUnion,
    DateSubset,
    DateSetEquals,
    DateTimeIntersection,
    DateTimeAtLeastOneMemberOf,
    DateTimeUnion,
    DateTimeSubset,
    DateTimeSetEquals,
    AnyURIIntersection,
    AnyURIAtLeastOneMemberOf,
    AnyURIUnion,
    AnyURISubset,
    AnyURISetEquals,
    HexBinaryIntersection,
    HexBinaryAtLeastOneMemberOf,
    HexBinaryUnion,
    HexBinarySubset,
    HexBinarySetEquals,
    Base64BinaryIntersection,
    Base64BinaryAtLeastOneMemberOf,
    Base64BinaryUnion,
    Base64BinarySubset,
    Base64BinarySetEquals,
    DayTimeDurationIntersection,
    DayTimeDurationAtLeastOneMemberOf,
    DayTimeDurationUnion,
    DayTimeDurationSubset,
    DayTimeDurationSetEquals,
    YearMonthDurationIntersection,
    YearMonthDurationAtLeastOneMemberOf,
    YearMonthDurationUnion,
    YearMonthDurationSubset,
    YearMonthDurationSetEquals,
    X500NameIntersection,
    X500NameAtLeastOneMemberOf,
    X500NameUnion,
    X500NameSubset,
    X500NameSetEquals,
    Rfc822NameIntersection,
    Rfc822NameAtLeastOneMemberOf,
    Rfc822NameUnion,
    Rfc822NameSubset,
    Rfc822NameSetEquals,
    AccessPermitted
}

impl FromStr for FunctionId {
    type Err = ();

    fn from_str(s: &str) -> Result<Self, Self::Err> {
        match s {
            "urn:oasis:names:tc:xacml:1.0:function:string-equal" => Ok(Self::StringEqual),
            "urn:oasis:names:tc:xacml:1.0:function:boolean-equal" => Ok(Self::BooleanEqual),
            "urn:oasis:names:tc:xacml:1.0:function:integer-equal" => Ok(Self::IntegerEqual),
            "urn:oasis:names:tc:xacml:1.0:function:double-equal" => Ok(Self::DoubleEqual),
            "urn:oasis:names:tc:xacml:1.0:function:date-equal" => Ok(Self::DateEqual),
            "urn:oasis:names:tc:xacml:1.0:function:time-equal" => Ok(Self::TimeEqual),
            "urn:oasis:names:tc:xacml:1.0:function:dateTime-equal" => Ok(Self::DateTimeEqual),
            "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-equal" => Ok(Self::DayTimeDurationEqual),
            "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-equal" => Ok(Self::YearMonthDurationEqual),
            "urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case" => Ok(Self::StringEqualIgnoreCase),
            "urn:oasis:names:tc:xacml:1.0:function:anyURI-equal" => Ok(Self::AnyURIEqual),
            "urn:oasis:names:tc:xacml:1.0:function:x500Name-equal" => Ok(Self::X500NameEqual),
            "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-equal" => Ok(Self::Rfc822NameEqual),
            "urn:oasis:names:tc:xacml:1.0:function:hexBinary-equal" => Ok(Self::HexBinaryEqual),
            "urn:oasis:names:tc:xacml:1.0:function:base64Binary-equal" => Ok(Self::Base64BinaryEqual),
            "urn:oasis:names:tc:xacml:1.0:function:integer-add" => Ok(Self::IntegerAdd),
            "urn:oasis:names:tc:xacml:1.0:function:double-add" => Ok(Self::DoubleAdd),
            "urn:oasis:names:tc:xacml:1.0:function:integer-subtract" => Ok(Self::IntegerSubtract),
            "urn:oasis:names:tc:xacml:1.0:function:double-subtract" => Ok(Self::DoubleSubtract),
            "urn:oasis:names:tc:xacml:1.0:function:integer-multiply" => Ok(Self::IntegerMultiply),
            "urn:oasis:names:tc:xacml:1.0:function:double-multiply" => Ok(Self::DoubleMultiply),
            "urn:oasis:names:tc:xacml:1.0:function:integer-divide" => Ok(Self::IntegerDivide),
            "urn:oasis:names:tc:xacml:1.0:function:double-divide" => Ok(Self::DoubleDivide),
            "urn:oasis:names:tc:xacml:1.0:function:integer-mod" => Ok(Self::IntegerMod),
            "urn:oasis:names:tc:xacml:1.0:function:integer-abs" => Ok(Self::IntegerAbs),
            "urn:oasis:names:tc:xacml:1.0:function:double-abs" => Ok(Self::DoubleAbs),
            "urn:oasis:names:tc:xacml:1.0:function:round" => Ok(Self::Round),
            "urn:oasis:names:tc:xacml:1.0:function:floor" => Ok(Self::Floor),
            "urn:oasis:names:tc:xacml:1.0:function:string-normalize-space" => Ok(Self::StringNormalizeSpace),
            "urn:oasis:names:tc:xacml:1.0:function:string-normalize-to-lower-case" => Ok(Self::StringNormalizeToLowerCase),
            "urn:oasis:names:tc:xacml:1.0:function:double-to-integer" => Ok(Self::DoubleToInteger),
            "urn:oasis:names:tc:xacml:1.0:function:integer-to-double" => Ok(Self::IntegerToDouble),
            "urn:oasis:names:tc:xacml:1.0:function:or" => Ok(Self::Or),
            "urn:oasis:names:tc:xacml:1.0:function:and" => Ok(Self::And),
            "urn:oasis:names:tc:xacml:1.0:function:n-of" => Ok(Self::NOf),
            "urn:oasis:names:tc:xacml:1.0:function:not" => Ok(Self::Not),
            "urn:oasis:names:tc:xacml:1.0:function:integer-greater-than" => Ok(Self::IntegerGreaterThan),
            "urn:oasis:names:tc:xacml:1.0:function:integer-greater-than-or-equal" => Ok(Self::IntegerGreaterThanOrEqual),
            "urn:oasis:names:tc:xacml:1.0:function:integer-less-than" => Ok(Self::IntegerLessThan),
            "urn:oasis:names:tc:xacml:1.0:function:integer-less-than-or-equal" => Ok(Self::IntegerLessThanOrEqual),
            "urn:oasis:names:tc:xacml:1.0:function:double-greater-than" => Ok(Self::DoubleGreaterThan),
            "urn:oasis:names:tc:xacml:1.0:function:double-greater-than-or-equal" => Ok(Self::DoubleGreaterThanOrEqual),
            "urn:oasis:names:tc:xacml:1.0:function:double-less-than" => Ok(Self::DoubleLessThan),
            "urn:oasis:names:tc:xacml:1.0:function:double-less-than-or-equal" => Ok(Self::DoubleLessThanOrEqual),
            "urn:oasis:names:tc:xacml:3.0:function:dateTime-add-dayTimeDuration" => Ok(Self::DateTimeAddDayTimeDuration),
            "urn:oasis:names:tc:xacml:3.0:function:dateTime-add-yearMonthDuration" => Ok(Self::DateTimeAddYearMonthDuration),
            "urn:oasis:names:tc:xacml:3.0:function:dateTime-subtract-dayTimeDuration" => Ok(Self::DateTimeSubtractDayTimeDuration),
            "urn:oasis:names:tc:xacml:3.0:function:dateTime-subtract-yearMonthDuration" => Ok(Self::DateTimeSubtractYearMonthDuration),
            "urn:oasis:names:tc:xacml:3.0:function:date-add-yearMonthDuration" => Ok(Self::DateAddYearMonthDuration),
            "urn:oasis:names:tc:xacml:3.0:function:date-subtract-yearMonthDuration" => Ok(Self::DateSubtractYearMonthDuration),
            "urn:oasis:names:tc:xacml:1.0:function:string-greater-than" => Ok(Self::StringGreaterThan),
            "urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal" => Ok(Self::StringGreaterThanOrEqual),
            "urn:oasis:names:tc:xacml:1.0:function:string-less-than" => Ok(Self::StringLessThan),
            "urn:oasis:names:tc:xacml:1.0:function:string-less-than-or-equal" => Ok(Self::StringLessThanOrEqual),
            "urn:oasis:names:tc:xacml:1.0:function:time-greater-than" => Ok(Self::TimeGreaterThan),
            "urn:oasis:names:tc:xacml:1.0:function:time-greater-than-or-equal" => Ok(Self::TimeGreaterThanOrEqual),
            "urn:oasis:names:tc:xacml:1.0:function:time-less-than" => Ok(Self::TimeLessThan),
            "urn:oasis:names:tc:xacml:1.0:function:time-less-than-or-equal" => Ok(Self::TimeLessThanOrEqual),
            "urn:oasis:names:tc:xacml:2.0:function:time-in-range" => Ok(Self::TimeInRange),
            "urn:oasis:names:tc:xacml:1.0:function:dateTime-greater-than" => Ok(Self::DateTimeGreaterThan),
            "urn:oasis:names:tc:xacml:1.0:function:dateTime-greater-than-or-equal" => Ok(Self::DateTimeGreaterThanOrEqual),
            "urn:oasis:names:tc:xacml:1.0:function:dateTime-less-than" => Ok(Self::DateTimeLessThan),
            "urn:oasis:names:tc:xacml:1.0:function:dateTime-less-than-or-equal" => Ok(Self::DateTimeLessThanOrEqual),
            "urn:oasis:names:tc:xacml:1.0:function:date-greater-than" => Ok(Self::DateGreaterThan),
            "urn:oasis:names:tc:xacml:1.0:function:date-greater-than-or-equal" => Ok(Self::DateGreaterThanOrEqual),
            "urn:oasis:names:tc:xacml:1.0:function:date-less-than" => Ok(Self::DateLessThan),
            "urn:oasis:names:tc:xacml:1.0:function:date-less-than-or-equal" => Ok(Self::DateLessThanOrEqual),
            "urn:oasis:names:tc:xacml:1.0:function:string-one-and-only" => Ok(Self::StringOneAndOnly),
            "urn:oasis:names:tc:xacml:1.0:function:string-bag-size" => Ok(Self::StringBagSize),
            "urn:oasis:names:tc:xacml:1.0:function:string-is-in" => Ok(Self::StringIsIn),
            "urn:oasis:names:tc:xacml:1.0:function:string-bag" => Ok(Self::StringBag),
            "urn:oasis:names:tc:xacml:1.0:function:boolean-one-and-only" => Ok(Self::BooleanOneAndOnly),
            "urn:oasis:names:tc:xacml:1.0:function:boolean-bag-size" => Ok(Self::BooleanBagSize),
            "urn:oasis:names:tc:xacml:1.0:function:boolean-is-in" => Ok(Self::BooleanIsIn),
            "urn:oasis:names:tc:xacml:1.0:function:boolean-bag" => Ok(Self::BooleanBag),
            "urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only" => Ok(Self::IntegerOneAndOnly),
            "urn:oasis:names:tc:xacml:1.0:function:integer-bag-size" => Ok(Self::IntegerBagSize),
            "urn:oasis:names:tc:xacml:1.0:function:integer-is-in" => Ok(Self::IntegerIsIn),
            "urn:oasis:names:tc:xacml:1.0:function:integer-bag" => Ok(Self::IntegerBag),
            "urn:oasis:names:tc:xacml:1.0:function:double-one-and-only" => Ok(Self::DoubleOneAndOnly),
            "urn:oasis:names:tc:xacml:1.0:function:double-bag-size" => Ok(Self::DoubleBagSize),
            "urn:oasis:names:tc:xacml:1.0:function:double-is-in" => Ok(Self::DoubleIsIn),
            "urn:oasis:names:tc:xacml:1.0:function:double-bag" => Ok(Self::DoubleBag),
            "urn:oasis:names:tc:xacml:1.0:function:time-one-and-only" => Ok(Self::TimeOneAndOnly),
            "urn:oasis:names:tc:xacml:1.0:function:time-bag-size" => Ok(Self::TimeBagSize),
            "urn:oasis:names:tc:xacml:1.0:function:time-is-in" => Ok(Self::TimeIsIn),
            "urn:oasis:names:tc:xacml:1.0:function:time-bag" => Ok(Self::TimeBag),
            "urn:oasis:names:tc:xacml:1.0:function:date-one-and-only" => Ok(Self::DateOneAndOnly),
            "urn:oasis:names:tc:xacml:1.0:function:date-bag-size" => Ok(Self::DateBagSize),
            "urn:oasis:names:tc:xacml:1.0:function:date-is-in" => Ok(Self::DateIsIn),
            "urn:oasis:names:tc:xacml:1.0:function:date-bag" => Ok(Self::DateBag),
            "urn:oasis:names:tc:xacml:1.0:function:dateTime-one-and-only" => Ok(Self::DateTimeOneAndOnly),
            "urn:oasis:names:tc:xacml:1.0:function:dateTime-bag-size" => Ok(Self::DateTimeBagSize),
            "urn:oasis:names:tc:xacml:1.0:function:dateTime-is-in" => Ok(Self::DateTimeIsIn),
            "urn:oasis:names:tc:xacml:1.0:function:dateTime-bag" => Ok(Self::DateTimeBag),
            "urn:oasis:names:tc:xacml:1.0:function:anyURI-one-and-only" => Ok(Self::AnyURIOneAndOnly),
            "urn:oasis:names:tc:xacml:1.0:function:anyURI-bag-size" => Ok(Self::AnyURIBagSize),
            "urn:oasis:names:tc:xacml:1.0:function:anyURI-is-in" => Ok(Self::AnyURIIsIn),
            "urn:oasis:names:tc:xacml:1.0:function:anyURI-bag" => Ok(Self::AnyURIBag),
            "urn:oasis:names:tc:xacml:1.0:function:hexBinary-one-and-only" => Ok(Self::HexBinaryOneAndOnly),
            "urn:oasis:names:tc:xacml:1.0:function:hexBinary-bag-size" => Ok(Self::HexBinaryBagSize),
            "urn:oasis:names:tc:xacml:1.0:function:hexBinary-is-in" => Ok(Self::HexBinaryIsIn),
            "urn:oasis:names:tc:xacml:1.0:function:hexBinary-bag" => Ok(Self::HexBinaryBag),
            "urn:oasis:names:tc:xacml:1.0:function:base64Binary-one-and-only" => Ok(Self::Base64BinaryOneAndOnly),
            "urn:oasis:names:tc:xacml:1.0:function:base64Binary-bag-size" => Ok(Self::Base64BinaryBagSize),
            "urn:oasis:names:tc:xacml:1.0:function:base64Binary-is-in" => Ok(Self::Base64BinaryIsIn),
            "urn:oasis:names:tc:xacml:1.0:function:base64Binary-bag" => Ok(Self::Base64BinaryBag),
            "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-one-and-only" => Ok(Self::DayTimeDurationOneAndOnly),
            "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-bag-size" => Ok(Self::DayTimeDurationBagSize),
            "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-is-in" => Ok(Self::DayTimeDurationIsIn),
            "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-bag" => Ok(Self::DayTimeDurationBag),
            "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-one-and-only" => Ok(Self::YearMonthDurationOneAndOnly),
            "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-bag-size" => Ok(Self::YearMonthDurationBagSize),
            "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-is-in" => Ok(Self::YearMonthDurationIsIn),
            "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-bag" => Ok(Self::YearMonthDurationBag),
            "urn:oasis:names:tc:xacml:1.0:function:x500Name-one-and-only" => Ok(Self::X500NameOneAndOnly),
            "urn:oasis:names:tc:xacml:1.0:function:x500Name-bag-size" => Ok(Self::X500NameBagSize),
            "urn:oasis:names:tc:xacml:1.0:function:x500Name-is-in" => Ok(Self::X500NameIsIn),
            "urn:oasis:names:tc:xacml:1.0:function:x500Name-bag" => Ok(Self::X500NameBag),
            "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-one-and-only" => Ok(Self::Rfc822NameOneAndOnly),
            "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-bag-size" => Ok(Self::Rfc822NameBagSize),
            "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-is-in" => Ok(Self::Rfc822NameIsIn),
            "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-bag" => Ok(Self::Rfc822NameBag),
            "urn:oasis:names:tc:xacml:2.0:function:ipAddress-one-and-only" => Ok(Self::IpAddressOneAndOnly),
            "urn:oasis:names:tc:xacml:2.0:function:ipAddress-bag-size" => Ok(Self::IpAddressBagSize),
            "urn:oasis:names:tc:xacml:2.0:function:ipAddress-bag" => Ok(Self::IpAddressBag),
            "urn:oasis:names:tc:xacml:2.0:function:dnsName-one-and-only" => Ok(Self::DnsNameOneAndOnly),
            "urn:oasis:names:tc:xacml:2.0:function:dnsName-bag-size" => Ok(Self::DnsNameBagSize),
            "urn:oasis:names:tc:xacml:2.0:function:dnsName-bag" => Ok(Self::DnsNameBag),
            "urn:oasis:names:tc:xacml:2.0:function:string-concatenate" => Ok(Self::StringConcatenate),
            "urn:oasis:names:tc:xacml:3.0:function:boolean-from-string" => Ok(Self::BooleanFromString),
            "urn:oasis:names:tc:xacml:3.0:function:string-from-boolean" => Ok(Self::StringFromBoolean),
            "urn:oasis:names:tc:xacml:3.0:function:integer-from-string" => Ok(Self::IntegerFromString),
            "urn:oasis:names:tc:xacml:3.0:function:string-from-integer" => Ok(Self::StringFromInteger),
            "urn:oasis:names:tc:xacml:3.0:function:double-from-string" => Ok(Self::DoubleFromString),
            "urn:oasis:names:tc:xacml:3.0:function:string-from-double" => Ok(Self::StringFromDouble),
            "urn:oasis:names:tc:xacml:3.0:function:time-from-string" => Ok(Self::TimeFromString),
            "urn:oasis:names:tc:xacml:3.0:function:string-from-time" => Ok(Self::StringFromTime),
            "urn:oasis:names:tc:xacml:3.0:function:date-from-string" => Ok(Self::DateFromString),
            "urn:oasis:names:tc:xacml:3.0:function:string-from-date" => Ok(Self::StringFromDate),
            "urn:oasis:names:tc:xacml:3.0:function:dateTime-from-string" => Ok(Self::DateTimeFromString),
            "urn:oasis:names:tc:xacml:3.0:function:string-from-dateTime" => Ok(Self::StringFromDateTime),
            "urn:oasis:names:tc:xacml:3.0:function:anyURI-from-string" => Ok(Self::AnyURIFromString),
            "urn:oasis:names:tc:xacml:3.0:function:string-from-anyURI" => Ok(Self::StringFromAnyURI),
            "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-from-string" => Ok(Self::DayTimeDurationFromString),
            "urn:oasis:names:tc:xacml:3.0:function:string-from-dayTimeDuration" => Ok(Self::StringFromDayTimeDuration),
            "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-from-string" => Ok(Self::YearMonthDurationFromString),
            "urn:oasis:names:tc:xacml:3.0:function:string-from-yearMonthDuration" => Ok(Self::StringFromYearMonthDuration),
            "urn:oasis:names:tc:xacml:3.0:function:x500Name-from-string" => Ok(Self::X500NameFromString),
            "urn:oasis:names:tc:xacml:3.0:function:string-from-x500Name" => Ok(Self::StringFromX500Name),
            "urn:oasis:names:tc:xacml:3.0:function:rfc822Name-from-string" => Ok(Self::Rfc822NameFromString),
            "urn:oasis:names:tc:xacml:3.0:function:string-from-rfc822Name" => Ok(Self::StringFromRfc822Name),
            "urn:oasis:names:tc:xacml:3.0:function:ipAddress-from-string" => Ok(Self::IpAddressFromString),
            "urn:oasis:names:tc:xacml:3.0:function:string-from-ipAddress" => Ok(Self::StringFromIpAddress),
            "urn:oasis:names:tc:xacml:3.0:function:dnsName-from-string" => Ok(Self::DnsNameFromString),
            "urn:oasis:names:tc:xacml:3.0:function:string-from-dnsName" => Ok(Self::StringFromDnsName),
            "urn:oasis:names:tc:xacml:3.0:function:string-starts-with" => Ok(Self::StringStartsWith),
            "urn:oasis:names:tc:xacml:3.0:function:anyURI-starts-with" => Ok(Self::AnyURIStartsWith),
            "urn:oasis:names:tc:xacml:3.0:function:string-ends-with" => Ok(Self::StringEndsWith),
            "urn:oasis:names:tc:xacml:3.0:function:anyURI-ends-with" => Ok(Self::AnyURIEndsWith),
            "urn:oasis:names:tc:xacml:3.0:function:string-contains" => Ok(Self::StringContains),
            "urn:oasis:names:tc:xacml:3.0:function:anyURI-contains" => Ok(Self::AnyURIContains),
            "urn:oasis:names:tc:xacml:3.0:function:string-substring" => Ok(Self::StringSubstring),
            "urn:oasis:names:tc:xacml:3.0:function:anyURI-substring" => Ok(Self::AnyURISubstring),
            "urn:oasis:names:tc:xacml:3.0:function:any-of" => Ok(Self::AnyOf),
            "urn:oasis:names:tc:xacml:3.0:function:all-of" => Ok(Self::AllOf),
            "urn:oasis:names:tc:xacml:3.0:function:any-of-any" => Ok(Self::AnyOfAny),
            "urn:oasis:names:tc:xacml:1.0:function:all-of-any" => Ok(Self::AllOfAny),
            "urn:oasis:names:tc:xacml:1.0:function:any-of-all" => Ok(Self::AnyOfAll),
            "urn:oasis:names:tc:xacml:1.0:function:all-of-all" => Ok(Self::AllOfAll),
            "urn:oasis:names:tc:xacml:3.0:function:map" => Ok(Self::Map),
            "urn:oasis:names:tc:xacml:1.0:function:x500Name-match" => Ok(Self::X500NameMatch),
            "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-match" => Ok(Self::Rfc822NameMatch),
            "urn:oasis:names:tc:xacml:1.0:function:string-regexp-match" => Ok(Self::StringRegexpMatch),
            "urn:oasis:names:tc:xacml:2.0:function:anyURI-regexp-match" => Ok(Self::AnyURIRegexpMatch),
            "urn:oasis:names:tc:xacml:2.0:function:ipAddress-regexp-match" => Ok(Self::IpAddressRegexpMatch),
            "urn:oasis:names:tc:xacml:2.0:function:dnsName-regexp-match" => Ok(Self::DnsNameRegexpMatch),
            "urn:oasis:names:tc:xacml:2.0:function:rfc822Name-regexp-match" => Ok(Self::Rfc822NameRegexpMatch),
            "urn:oasis:names:tc:xacml:2.0:function:x500Name-regexp-match" => Ok(Self::X500NameRegexpMatch),
            "urn:oasis:names:tc:xacml:3.0:function:xpath-node-count" => Ok(Self::XpathNodeCount),
            "urn:oasis:names:tc:xacml:3.0:function:xpath-node-equal" => Ok(Self::XpathNodeEqual),
            "urn:oasis:names:tc:xacml:3.0:function:xpath-node-match" => Ok(Self::XpathNodeMatch),
            "urn:oasis:names:tc:xacml:1.0:function:string-intersection" => Ok(Self::StringIntersection),
            "urn:oasis:names:tc:xacml:1.0:function:string-at-least-one-member-of" => Ok(Self::StringAtLeastOneMemberOf),
            "urn:oasis:names:tc:xacml:1.0:function:string-union" => Ok(Self::StringUnion),
            "urn:oasis:names:tc:xacml:1.0:function:string-subset" => Ok(Self::StringSubset),
            "urn:oasis:names:tc:xacml:1.0:function:string-set-equals" => Ok(Self::StringSetEquals),
            "urn:oasis:names:tc:xacml:1.0:function:boolean-intersection" => Ok(Self::BooleanIntersection),
            "urn:oasis:names:tc:xacml:1.0:function:boolean-at-least-one-member-of" => Ok(Self::BooleanAtLeastOneMemberOf),
            "urn:oasis:names:tc:xacml:1.0:function:boolean-union" => Ok(Self::BooleanUnion),
            "urn:oasis:names:tc:xacml:1.0:function:boolean-subset" => Ok(Self::BooleanSubset),
            "urn:oasis:names:tc:xacml:1.0:function:boolean-set-equals" => Ok(Self::BooleanSetEquals),
            "urn:oasis:names:tc:xacml:1.0:function:integer-intersection" => Ok(Self::IntegerIntersection),
            "urn:oasis:names:tc:xacml:1.0:function:integer-at-least-one-member-of" => Ok(Self::IntegerAtLeastOneMemberOf),
            "urn:oasis:names:tc:xacml:1.0:function:integer-union" => Ok(Self::IntegerUnion),
            "urn:oasis:names:tc:xacml:1.0:function:integer-subset" => Ok(Self::IntegerSubset),
            "urn:oasis:names:tc:xacml:1.0:function:integer-set-equals" => Ok(Self::IntegerSetEquals),
            "urn:oasis:names:tc:xacml:1.0:function:double-intersection" => Ok(Self::DoubleIntersection),
            "urn:oasis:names:tc:xacml:1.0:function:double-at-least-one-member-of" => Ok(Self::DoubleAtLeastOneMemberOf),
            "urn:oasis:names:tc:xacml:1.0:function:double-union" => Ok(Self::DoubleUnion),
            "urn:oasis:names:tc:xacml:1.0:function:double-subset" => Ok(Self::DoubleSubset),
            "urn:oasis:names:tc:xacml:1.0:function:double-set-equals" => Ok(Self::DoubleSetEquals),
            "urn:oasis:names:tc:xacml:1.0:function:time-intersection" => Ok(Self::TimeIntersection),
            "urn:oasis:names:tc:xacml:1.0:function:time-at-least-one-member-of" => Ok(Self::TimeAtLeastOneMemberOf),
            "urn:oasis:names:tc:xacml:1.0:function:time-union" => Ok(Self::TimeUnion),
            "urn:oasis:names:tc:xacml:1.0:function:time-subset" => Ok(Self::TimeSubset),
            "urn:oasis:names:tc:xacml:1.0:function:time-set-equals" => Ok(Self::TimeSetEquals),
            "urn:oasis:names:tc:xacml:1.0:function:date-intersection" => Ok(Self::DateIntersection),
            "urn:oasis:names:tc:xacml:1.0:function:date-at-least-one-member-of" => Ok(Self::DateAtLeastOneMemberOf),
            "urn:oasis:names:tc:xacml:1.0:function:date-union" => Ok(Self::DateUnion),
            "urn:oasis:names:tc:xacml:1.0:function:date-subset" => Ok(Self::DateSubset),
            "urn:oasis:names:tc:xacml:1.0:function:date-set-equals" => Ok(Self::DateSetEquals),
            "urn:oasis:names:tc:xacml:1.0:function:dateTime-intersection" => Ok(Self::DateTimeIntersection),
            "urn:oasis:names:tc:xacml:1.0:function:dateTime-at-least-one-member-of" => Ok(Self::DateTimeAtLeastOneMemberOf),
            "urn:oasis:names:tc:xacml:1.0:function:dateTime-union" => Ok(Self::DateTimeUnion),
            "urn:oasis:names:tc:xacml:1.0:function:dateTime-subset" => Ok(Self::DateTimeSubset),
            "urn:oasis:names:tc:xacml:1.0:function:dateTime-set-equals" => Ok(Self::DateTimeSetEquals),
            "urn:oasis:names:tc:xacml:1.0:function:anyURI-intersection" => Ok(Self::AnyURIIntersection),
            "urn:oasis:names:tc:xacml:1.0:function:anyURI-at-least-one-member-of" => Ok(Self::AnyURIAtLeastOneMemberOf),
            "urn:oasis:names:tc:xacml:1.0:function:anyURI-union" => Ok(Self::AnyURIUnion),
            "urn:oasis:names:tc:xacml:1.0:function:anyURI-subset" => Ok(Self::AnyURISubset),
            "urn:oasis:names:tc:xacml:1.0:function:anyURI-set-equals" => Ok(Self::AnyURISetEquals),
            "urn:oasis:names:tc:xacml:1.0:function:hexBinary-intersection" => Ok(Self::HexBinaryIntersection),
            "urn:oasis:names:tc:xacml:1.0:function:hexBinary-at-least-one-member-of" => Ok(Self::HexBinaryAtLeastOneMemberOf),
            "urn:oasis:names:tc:xacml:1.0:function:hexBinary-union" => Ok(Self::HexBinaryUnion),
            "urn:oasis:names:tc:xacml:1.0:function:hexBinary-subset" => Ok(Self::HexBinarySubset),
            "urn:oasis:names:tc:xacml:1.0:function:hexBinary-set-equals" => Ok(Self::HexBinarySetEquals),
            "urn:oasis:names:tc:xacml:1.0:function:base64Binary-intersection" => Ok(Self::Base64BinaryIntersection),
            "urn:oasis:names:tc:xacml:1.0:function:base64Binary-at-least-one-member-of" => Ok(Self::Base64BinaryAtLeastOneMemberOf),
            "urn:oasis:names:tc:xacml:1.0:function:base64Binary-union" => Ok(Self::Base64BinaryUnion),
            "urn:oasis:names:tc:xacml:1.0:function:base64Binary-subset" => Ok(Self::Base64BinarySubset),
            "urn:oasis:names:tc:xacml:1.0:function:base64Binary-set-equals" => Ok(Self::Base64BinarySetEquals),
            "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-intersection" => Ok(Self::DayTimeDurationIntersection),
            "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-at-least-one-member-of" => Ok(Self::DayTimeDurationAtLeastOneMemberOf),
            "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-union" => Ok(Self::DayTimeDurationUnion),
            "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-subset" => Ok(Self::DayTimeDurationSubset),
            "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-set-equals" => Ok(Self::DayTimeDurationSetEquals),
            "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-intersection" => Ok(Self::YearMonthDurationIntersection),
            "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-at-least-one-member-of" => Ok(Self::YearMonthDurationAtLeastOneMemberOf),
            "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-union" => Ok(Self::YearMonthDurationUnion),
            "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-subset" => Ok(Self::YearMonthDurationSubset),
            "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-set-equals" => Ok(Self::YearMonthDurationSetEquals),
            "urn:oasis:names:tc:xacml:1.0:function:x500Name-intersection" => Ok(Self::X500NameIntersection),
            "urn:oasis:names:tc:xacml:1.0:function:x500Name-at-least-one-member-of" => Ok(Self::X500NameAtLeastOneMemberOf),
            "urn:oasis:names:tc:xacml:1.0:function:x500Name-union" => Ok(Self::X500NameUnion),
            "urn:oasis:names:tc:xacml:1.0:function:x500Name-subset" => Ok(Self::X500NameSubset),
            "urn:oasis:names:tc:xacml:1.0:function:x500Name-set-equals" => Ok(Self::X500NameSetEquals),
            "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-intersection" => Ok(Self::Rfc822NameIntersection),
            "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-at-least-one-member-of" => Ok(Self::Rfc822NameAtLeastOneMemberOf),
            "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-union" => Ok(Self::Rfc822NameUnion),
            "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-subset" => Ok(Self::Rfc822NameSubset),
            "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-set-equals" => Ok(Self::Rfc822NameSetEquals),
            "urn:oasis:names:tc:xacml:3.0:function:access-permitted" => Ok(Self::AccessPermitted),
            _ => Err(()),
        }
    }
}

#[allow(dead_code)]
impl FunctionId {
    pub fn to_xacml_id(&self) -> &'static str {
        match self {
            Self::StringEqual => "urn:oasis:names:tc:xacml:1.0:function:string-equal",
            Self::BooleanEqual => "urn:oasis:names:tc:xacml:1.0:function:boolean-equal",
            Self::IntegerEqual => "urn:oasis:names:tc:xacml:1.0:function:integer-equal",
            Self::DoubleEqual => "urn:oasis:names:tc:xacml:1.0:function:double-equal",
            Self::DateEqual => "urn:oasis:names:tc:xacml:1.0:function:date-equal",
            Self::TimeEqual => "urn:oasis:names:tc:xacml:1.0:function:time-equal",
            Self::DateTimeEqual => "urn:oasis:names:tc:xacml:1.0:function:dateTime-equal",
            Self::DayTimeDurationEqual => "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-equal",
            Self::YearMonthDurationEqual => "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-equal",
            Self::StringEqualIgnoreCase => "urn:oasis:names:tc:xacml:3.0:function:string-equal-ignore-case",
            Self::AnyURIEqual => "urn:oasis:names:tc:xacml:1.0:function:anyURI-equal",
            Self::X500NameEqual => "urn:oasis:names:tc:xacml:1.0:function:x500Name-equal",
            Self::Rfc822NameEqual => "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-equal",
            Self::HexBinaryEqual => "urn:oasis:names:tc:xacml:1.0:function:hexBinary-equal",
            Self::Base64BinaryEqual => "urn:oasis:names:tc:xacml:1.0:function:base64Binary-equal",
            Self::IntegerAdd => "urn:oasis:names:tc:xacml:1.0:function:integer-add",
            Self::DoubleAdd => "urn:oasis:names:tc:xacml:1.0:function:double-add",
            Self::IntegerSubtract => "urn:oasis:names:tc:xacml:1.0:function:integer-subtract",
            Self::DoubleSubtract => "urn:oasis:names:tc:xacml:1.0:function:double-subtract",
            Self::IntegerMultiply => "urn:oasis:names:tc:xacml:1.0:function:integer-multiply",
            Self::DoubleMultiply => "urn:oasis:names:tc:xacml:1.0:function:double-multiply",
            Self::IntegerDivide => "urn:oasis:names:tc:xacml:1.0:function:integer-divide",
            Self::DoubleDivide => "urn:oasis:names:tc:xacml:1.0:function:double-divide",
            Self::IntegerMod => "urn:oasis:names:tc:xacml:1.0:function:integer-mod",
            Self::IntegerAbs => "urn:oasis:names:tc:xacml:1.0:function:integer-abs",
            Self::DoubleAbs => "urn:oasis:names:tc:xacml:1.0:function:double-abs",
            Self::Round => "urn:oasis:names:tc:xacml:1.0:function:round",
            Self::Floor => "urn:oasis:names:tc:xacml:1.0:function:floor",
            Self::StringNormalizeSpace => "urn:oasis:names:tc:xacml:1.0:function:string-normalize-space",
            Self::StringNormalizeToLowerCase => "urn:oasis:names:tc:xacml:1.0:function:string-normalize-to-lower-case",
            Self::DoubleToInteger => "urn:oasis:names:tc:xacml:1.0:function:double-to-integer",
            Self::IntegerToDouble => "urn:oasis:names:tc:xacml:1.0:function:integer-to-double",
            Self::Or => "urn:oasis:names:tc:xacml:1.0:function:or",
            Self::And => "urn:oasis:names:tc:xacml:1.0:function:and",
            Self::NOf => "urn:oasis:names:tc:xacml:1.0:function:n-of",
            Self::Not => "urn:oasis:names:tc:xacml:1.0:function:not",
            Self::IntegerGreaterThan => "urn:oasis:names:tc:xacml:1.0:function:integer-greater-than",
            Self::IntegerGreaterThanOrEqual => "urn:oasis:names:tc:xacml:1.0:function:integer-greater-than-or-equal",
            Self::IntegerLessThan => "urn:oasis:names:tc:xacml:1.0:function:integer-less-than",
            Self::IntegerLessThanOrEqual => "urn:oasis:names:tc:xacml:1.0:function:integer-less-than-or-equal",
            Self::DoubleGreaterThan => "urn:oasis:names:tc:xacml:1.0:function:double-greater-than",
            Self::DoubleGreaterThanOrEqual => "urn:oasis:names:tc:xacml:1.0:function:double-greater-than-or-equal",
            Self::DoubleLessThan => "urn:oasis:names:tc:xacml:1.0:function:double-less-than",
            Self::DoubleLessThanOrEqual => "urn:oasis:names:tc:xacml:1.0:function:double-less-than-or-equal",
            Self::DateTimeAddDayTimeDuration => "urn:oasis:names:tc:xacml:3.0:function:dateTime-add-dayTimeDuration",
            Self::DateTimeAddYearMonthDuration => "urn:oasis:names:tc:xacml:3.0:function:dateTime-add-yearMonthDuration",
            Self::DateTimeSubtractDayTimeDuration => "urn:oasis:names:tc:xacml:3.0:function:dateTime-subtract-dayTimeDuration",
            Self::DateTimeSubtractYearMonthDuration => "urn:oasis:names:tc:xacml:3.0:function:dateTime-subtract-yearMonthDuration",
            Self::DateAddYearMonthDuration => "urn:oasis:names:tc:xacml:3.0:function:date-add-yearMonthDuration",
            Self::DateSubtractYearMonthDuration => "urn:oasis:names:tc:xacml:3.0:function:date-subtract-yearMonthDuration",
            Self::StringGreaterThan => "urn:oasis:names:tc:xacml:1.0:function:string-greater-than",
            Self::StringGreaterThanOrEqual => "urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal",
            Self::StringLessThan => "urn:oasis:names:tc:xacml:1.0:function:string-less-than",
            Self::StringLessThanOrEqual => "urn:oasis:names:tc:xacml:1.0:function:string-less-than-or-equal",
            Self::TimeGreaterThan => "urn:oasis:names:tc:xacml:1.0:function:time-greater-than",
            Self::TimeGreaterThanOrEqual => "urn:oasis:names:tc:xacml:1.0:function:time-greater-than-or-equal",
            Self::TimeLessThan => "urn:oasis:names:tc:xacml:1.0:function:time-less-than",
            Self::TimeLessThanOrEqual => "urn:oasis:names:tc:xacml:1.0:function:time-less-than-or-equal",
            Self::TimeInRange => "urn:oasis:names:tc:xacml:2.0:function:time-in-range",
            Self::DateTimeGreaterThan => "urn:oasis:names:tc:xacml:1.0:function:dateTime-greater-than",
            Self::DateTimeGreaterThanOrEqual => "urn:oasis:names:tc:xacml:1.0:function:dateTime-greater-than-or-equal",
            Self::DateTimeLessThan => "urn:oasis:names:tc:xacml:1.0:function:dateTime-less-than",
            Self::DateTimeLessThanOrEqual => "urn:oasis:names:tc:xacml:1.0:function:dateTime-less-than-or-equal",
            Self::DateGreaterThan => "urn:oasis:names:tc:xacml:1.0:function:date-greater-than",
            Self::DateGreaterThanOrEqual => "urn:oasis:names:tc:xacml:1.0:function:date-greater-than-or-equal",
            Self::DateLessThan => "urn:oasis:names:tc:xacml:1.0:function:date-less-than",
            Self::DateLessThanOrEqual => "urn:oasis:names:tc:xacml:1.0:function:date-less-than-or-equal",
            Self::StringOneAndOnly => "urn:oasis:names:tc:xacml:1.0:function:string-one-and-only",
            Self::StringBagSize => "urn:oasis:names:tc:xacml:1.0:function:string-bag-size",
            Self::StringIsIn => "urn:oasis:names:tc:xacml:1.0:function:string-is-in",
            Self::StringBag => "urn:oasis:names:tc:xacml:1.0:function:string-bag",
            Self::BooleanOneAndOnly => "urn:oasis:names:tc:xacml:1.0:function:boolean-one-and-only",
            Self::BooleanBagSize => "urn:oasis:names:tc:xacml:1.0:function:boolean-bag-size",
            Self::BooleanIsIn => "urn:oasis:names:tc:xacml:1.0:function:boolean-is-in",
            Self::BooleanBag => "urn:oasis:names:tc:xacml:1.0:function:boolean-bag",
            Self::IntegerOneAndOnly => "urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only",
            Self::IntegerBagSize => "urn:oasis:names:tc:xacml:1.0:function:integer-bag-size",
            Self::IntegerIsIn => "urn:oasis:names:tc:xacml:1.0:function:integer-is-in",
            Self::IntegerBag => "urn:oasis:names:tc:xacml:1.0:function:integer-bag",
            Self::DoubleOneAndOnly => "urn:oasis:names:tc:xacml:1.0:function:double-one-and-only",
            Self::DoubleBagSize => "urn:oasis:names:tc:xacml:1.0:function:double-bag-size",
            Self::DoubleIsIn => "urn:oasis:names:tc:xacml:1.0:function:double-is-in",
            Self::DoubleBag => "urn:oasis:names:tc:xacml:1.0:function:double-bag",
            Self::TimeOneAndOnly => "urn:oasis:names:tc:xacml:1.0:function:time-one-and-only",
            Self::TimeBagSize => "urn:oasis:names:tc:xacml:1.0:function:time-bag-size",
            Self::TimeIsIn => "urn:oasis:names:tc:xacml:1.0:function:time-is-in",
            Self::TimeBag => "urn:oasis:names:tc:xacml:1.0:function:time-bag",
            Self::DateOneAndOnly => "urn:oasis:names:tc:xacml:1.0:function:date-one-and-only",
            Self::DateBagSize => "urn:oasis:names:tc:xacml:1.0:function:date-bag-size",
            Self::DateIsIn => "urn:oasis:names:tc:xacml:1.0:function:date-is-in",
            Self::DateBag => "urn:oasis:names:tc:xacml:1.0:function:date-bag",
            Self::DateTimeOneAndOnly => "urn:oasis:names:tc:xacml:1.0:function:dateTime-one-and-only",
            Self::DateTimeBagSize => "urn:oasis:names:tc:xacml:1.0:function:dateTime-bag-size",
            Self::DateTimeIsIn => "urn:oasis:names:tc:xacml:1.0:function:dateTime-is-in",
            Self::DateTimeBag => "urn:oasis:names:tc:xacml:1.0:function:dateTime-bag",
            Self::AnyURIOneAndOnly => "urn:oasis:names:tc:xacml:1.0:function:anyURI-one-and-only",
            Self::AnyURIBagSize => "urn:oasis:names:tc:xacml:1.0:function:anyURI-bag-size",
            Self::AnyURIIsIn => "urn:oasis:names:tc:xacml:1.0:function:anyURI-is-in",
            Self::AnyURIBag => "urn:oasis:names:tc:xacml:1.0:function:anyURI-bag",
            Self::HexBinaryOneAndOnly => "urn:oasis:names:tc:xacml:1.0:function:hexBinary-one-and-only",
            Self::HexBinaryBagSize => "urn:oasis:names:tc:xacml:1.0:function:hexBinary-bag-size",
            Self::HexBinaryIsIn => "urn:oasis:names:tc:xacml:1.0:function:hexBinary-is-in",
            Self::HexBinaryBag => "urn:oasis:names:tc:xacml:1.0:function:hexBinary-bag",
            Self::Base64BinaryOneAndOnly => "urn:oasis:names:tc:xacml:1.0:function:base64Binary-one-and-only",
            Self::Base64BinaryBagSize => "urn:oasis:names:tc:xacml:1.0:function:base64Binary-bag-size",
            Self::Base64BinaryIsIn => "urn:oasis:names:tc:xacml:1.0:function:base64Binary-is-in",
            Self::Base64BinaryBag => "urn:oasis:names:tc:xacml:1.0:function:base64Binary-bag",
            Self::DayTimeDurationOneAndOnly => "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-one-and-only",
            Self::DayTimeDurationBagSize => "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-bag-size",
            Self::DayTimeDurationIsIn => "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-is-in",
            Self::DayTimeDurationBag => "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-bag",
            Self::YearMonthDurationOneAndOnly => "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-one-and-only",
            Self::YearMonthDurationBagSize => "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-bag-size",
            Self::YearMonthDurationIsIn => "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-is-in",
            Self::YearMonthDurationBag => "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-bag",
            Self::X500NameOneAndOnly => "urn:oasis:names:tc:xacml:1.0:function:x500Name-one-and-only",
            Self::X500NameBagSize => "urn:oasis:names:tc:xacml:1.0:function:x500Name-bag-size",
            Self::X500NameIsIn => "urn:oasis:names:tc:xacml:1.0:function:x500Name-is-in",
            Self::X500NameBag => "urn:oasis:names:tc:xacml:1.0:function:x500Name-bag",
            Self::Rfc822NameOneAndOnly => "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-one-and-only",
            Self::Rfc822NameBagSize => "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-bag-size",
            Self::Rfc822NameIsIn => "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-is-in",
            Self::Rfc822NameBag => "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-bag",
            Self::IpAddressOneAndOnly => "urn:oasis:names:tc:xacml:2.0:function:ipAddress-one-and-only",
            Self::IpAddressBagSize => "urn:oasis:names:tc:xacml:2.0:function:ipAddress-bag-size",
            Self::IpAddressBag => "urn:oasis:names:tc:xacml:2.0:function:ipAddress-bag",
            Self::DnsNameOneAndOnly => "urn:oasis:names:tc:xacml:2.0:function:dnsName-one-and-only",
            Self::DnsNameBagSize => "urn:oasis:names:tc:xacml:2.0:function:dnsName-bag-size",
            Self::DnsNameBag => "urn:oasis:names:tc:xacml:2.0:function:dnsName-bag",
            Self::StringConcatenate => "urn:oasis:names:tc:xacml:2.0:function:string-concatenate",
            Self::BooleanFromString => "urn:oasis:names:tc:xacml:3.0:function:boolean-from-string",
            Self::StringFromBoolean => "urn:oasis:names:tc:xacml:3.0:function:string-from-boolean",
            Self::IntegerFromString => "urn:oasis:names:tc:xacml:3.0:function:integer-from-string",
            Self::StringFromInteger => "urn:oasis:names:tc:xacml:3.0:function:string-from-integer",
            Self::DoubleFromString => "urn:oasis:names:tc:xacml:3.0:function:double-from-string",
            Self::StringFromDouble => "urn:oasis:names:tc:xacml:3.0:function:string-from-double",
            Self::TimeFromString => "urn:oasis:names:tc:xacml:3.0:function:time-from-string",
            Self::StringFromTime => "urn:oasis:names:tc:xacml:3.0:function:string-from-time",
            Self::DateFromString => "urn:oasis:names:tc:xacml:3.0:function:date-from-string",
            Self::StringFromDate => "urn:oasis:names:tc:xacml:3.0:function:string-from-date",
            Self::DateTimeFromString => "urn:oasis:names:tc:xacml:3.0:function:dateTime-from-string",
            Self::StringFromDateTime => "urn:oasis:names:tc:xacml:3.0:function:string-from-dateTime",
            Self::AnyURIFromString => "urn:oasis:names:tc:xacml:3.0:function:anyURI-from-string",
            Self::StringFromAnyURI => "urn:oasis:names:tc:xacml:3.0:function:string-from-anyURI",
            Self::DayTimeDurationFromString => "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-from-string",
            Self::StringFromDayTimeDuration => "urn:oasis:names:tc:xacml:3.0:function:string-from-dayTimeDuration",
            Self::YearMonthDurationFromString => "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-from-string",
            Self::StringFromYearMonthDuration => "urn:oasis:names:tc:xacml:3.0:function:string-from-yearMonthDuration",
            Self::X500NameFromString => "urn:oasis:names:tc:xacml:3.0:function:x500Name-from-string",
            Self::StringFromX500Name => "urn:oasis:names:tc:xacml:3.0:function:string-from-x500Name",
            Self::Rfc822NameFromString => "urn:oasis:names:tc:xacml:3.0:function:rfc822Name-from-string",
            Self::StringFromRfc822Name => "urn:oasis:names:tc:xacml:3.0:function:string-from-rfc822Name",
            Self::IpAddressFromString => "urn:oasis:names:tc:xacml:3.0:function:ipAddress-from-string",
            Self::StringFromIpAddress => "urn:oasis:names:tc:xacml:3.0:function:string-from-ipAddress",
            Self::DnsNameFromString => "urn:oasis:names:tc:xacml:3.0:function:dnsName-from-string",
            Self::StringFromDnsName => "urn:oasis:names:tc:xacml:3.0:function:string-from-dnsName",
            Self::StringStartsWith => "urn:oasis:names:tc:xacml:3.0:function:string-starts-with",
            Self::AnyURIStartsWith => "urn:oasis:names:tc:xacml:3.0:function:anyURI-starts-with",
            Self::StringEndsWith => "urn:oasis:names:tc:xacml:3.0:function:string-ends-with",
            Self::AnyURIEndsWith => "urn:oasis:names:tc:xacml:3.0:function:anyURI-ends-with",
            Self::StringContains => "urn:oasis:names:tc:xacml:3.0:function:string-contains",
            Self::AnyURIContains => "urn:oasis:names:tc:xacml:3.0:function:anyURI-contains",
            Self::StringSubstring => "urn:oasis:names:tc:xacml:3.0:function:string-substring",
            Self::AnyURISubstring => "urn:oasis:names:tc:xacml:3.0:function:anyURI-substring",
            Self::AnyOf => "urn:oasis:names:tc:xacml:3.0:function:any-of",
            Self::AllOf => "urn:oasis:names:tc:xacml:3.0:function:all-of",
            Self::AnyOfAny => "urn:oasis:names:tc:xacml:3.0:function:any-of-any",
            Self::AllOfAny => "urn:oasis:names:tc:xacml:1.0:function:all-of-any",
            Self::AnyOfAll => "urn:oasis:names:tc:xacml:1.0:function:any-of-all",
            Self::AllOfAll => "urn:oasis:names:tc:xacml:1.0:function:all-of-all",
            Self::Map => "urn:oasis:names:tc:xacml:3.0:function:map",
            Self::X500NameMatch => "urn:oasis:names:tc:xacml:1.0:function:x500Name-match",
            Self::Rfc822NameMatch => "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-match",
            Self::StringRegexpMatch => "urn:oasis:names:tc:xacml:1.0:function:string-regexp-match",
            Self::AnyURIRegexpMatch => "urn:oasis:names:tc:xacml:2.0:function:anyURI-regexp-match",
            Self::IpAddressRegexpMatch => "urn:oasis:names:tc:xacml:2.0:function:ipAddress-regexp-match",
            Self::DnsNameRegexpMatch => "urn:oasis:names:tc:xacml:2.0:function:dnsName-regexp-match",
            Self::Rfc822NameRegexpMatch => "urn:oasis:names:tc:xacml:2.0:function:rfc822Name-regexp-match",
            Self::X500NameRegexpMatch => "urn:oasis:names:tc:xacml:2.0:function:x500Name-regexp-match",
            Self::XpathNodeCount => "urn:oasis:names:tc:xacml:3.0:function:xpath-node-count",
            Self::XpathNodeEqual => "urn:oasis:names:tc:xacml:3.0:function:xpath-node-equal",
            Self::XpathNodeMatch => "urn:oasis:names:tc:xacml:3.0:function:xpath-node-match",
            Self::StringIntersection => "urn:oasis:names:tc:xacml:1.0:function:string-intersection",
            Self::StringAtLeastOneMemberOf => "urn:oasis:names:tc:xacml:1.0:function:string-at-least-one-member-of",
            Self::StringUnion => "urn:oasis:names:tc:xacml:1.0:function:string-union",
            Self::StringSubset => "urn:oasis:names:tc:xacml:1.0:function:string-subset",
            Self::StringSetEquals => "urn:oasis:names:tc:xacml:1.0:function:string-set-equals",
            Self::BooleanIntersection => "urn:oasis:names:tc:xacml:1.0:function:boolean-intersection",
            Self::BooleanAtLeastOneMemberOf => "urn:oasis:names:tc:xacml:1.0:function:boolean-at-least-one-member-of",
            Self::BooleanUnion => "urn:oasis:names:tc:xacml:1.0:function:boolean-union",
            Self::BooleanSubset => "urn:oasis:names:tc:xacml:1.0:function:boolean-subset",
            Self::BooleanSetEquals => "urn:oasis:names:tc:xacml:1.0:function:boolean-set-equals",
            Self::IntegerIntersection => "urn:oasis:names:tc:xacml:1.0:function:integer-intersection",
            Self::IntegerAtLeastOneMemberOf => "urn:oasis:names:tc:xacml:1.0:function:integer-at-least-one-member-of",
            Self::IntegerUnion => "urn:oasis:names:tc:xacml:1.0:function:integer-union",
            Self::IntegerSubset => "urn:oasis:names:tc:xacml:1.0:function:integer-subset",
            Self::IntegerSetEquals => "urn:oasis:names:tc:xacml:1.0:function:integer-set-equals",
            Self::DoubleIntersection => "urn:oasis:names:tc:xacml:1.0:function:double-intersection",
            Self::DoubleAtLeastOneMemberOf => "urn:oasis:names:tc:xacml:1.0:function:double-at-least-one-member-of",
            Self::DoubleUnion => "urn:oasis:names:tc:xacml:1.0:function:double-union",
            Self::DoubleSubset => "urn:oasis:names:tc:xacml:1.0:function:double-subset",
            Self::DoubleSetEquals => "urn:oasis:names:tc:xacml:1.0:function:double-set-equals",
            Self::TimeIntersection => "urn:oasis:names:tc:xacml:1.0:function:time-intersection",
            Self::TimeAtLeastOneMemberOf => "urn:oasis:names:tc:xacml:1.0:function:time-at-least-one-member-of",
            Self::TimeUnion => "urn:oasis:names:tc:xacml:1.0:function:time-union",
            Self::TimeSubset => "urn:oasis:names:tc:xacml:1.0:function:time-subset",
            Self::TimeSetEquals => "urn:oasis:names:tc:xacml:1.0:function:time-set-equals",
            Self::DateIntersection => "urn:oasis:names:tc:xacml:1.0:function:date-intersection",
            Self::DateAtLeastOneMemberOf => "urn:oasis:names:tc:xacml:1.0:function:date-at-least-one-member-of",
            Self::DateUnion => "urn:oasis:names:tc:xacml:1.0:function:date-union",
            Self::DateSubset => "urn:oasis:names:tc:xacml:1.0:function:date-subset",
            Self::DateSetEquals => "urn:oasis:names:tc:xacml:1.0:function:date-set-equals",
            Self::DateTimeIntersection => "urn:oasis:names:tc:xacml:1.0:function:dateTime-intersection",
            Self::DateTimeAtLeastOneMemberOf => "urn:oasis:names:tc:xacml:1.0:function:dateTime-at-least-one-member-of",
            Self::DateTimeUnion => "urn:oasis:names:tc:xacml:1.0:function:dateTime-union",
            Self::DateTimeSubset => "urn:oasis:names:tc:xacml:1.0:function:dateTime-subset",
            Self::DateTimeSetEquals => "urn:oasis:names:tc:xacml:1.0:function:dateTime-set-equals",
            Self::AnyURIIntersection => "urn:oasis:names:tc:xacml:1.0:function:anyURI-intersection",
            Self::AnyURIAtLeastOneMemberOf => "urn:oasis:names:tc:xacml:1.0:function:anyURI-at-least-one-member-of",
            Self::AnyURIUnion => "urn:oasis:names:tc:xacml:1.0:function:anyURI-union",
            Self::AnyURISubset => "urn:oasis:names:tc:xacml:1.0:function:anyURI-subset",
            Self::AnyURISetEquals => "urn:oasis:names:tc:xacml:1.0:function:anyURI-set-equals",
            Self::HexBinaryIntersection => "urn:oasis:names:tc:xacml:1.0:function:hexBinary-intersection",
            Self::HexBinaryAtLeastOneMemberOf => "urn:oasis:names:tc:xacml:1.0:function:hexBinary-at-least-one-member-of",
            Self::HexBinaryUnion => "urn:oasis:names:tc:xacml:1.0:function:hexBinary-union",
            Self::HexBinarySubset => "urn:oasis:names:tc:xacml:1.0:function:hexBinary-subset",
            Self::HexBinarySetEquals => "urn:oasis:names:tc:xacml:1.0:function:hexBinary-set-equals",
            Self::Base64BinaryIntersection => "urn:oasis:names:tc:xacml:1.0:function:base64Binary-intersection",
            Self::Base64BinaryAtLeastOneMemberOf => "urn:oasis:names:tc:xacml:1.0:function:base64Binary-at-least-one-member-of",
            Self::Base64BinaryUnion => "urn:oasis:names:tc:xacml:1.0:function:base64Binary-union",
            Self::Base64BinarySubset => "urn:oasis:names:tc:xacml:1.0:function:base64Binary-subset",
            Self::Base64BinarySetEquals => "urn:oasis:names:tc:xacml:1.0:function:base64Binary-set-equals",
            Self::DayTimeDurationIntersection => "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-intersection",
            Self::DayTimeDurationAtLeastOneMemberOf => "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-at-least-one-member-of",
            Self::DayTimeDurationUnion => "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-union",
            Self::DayTimeDurationSubset => "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-subset",
            Self::DayTimeDurationSetEquals => "urn:oasis:names:tc:xacml:3.0:function:dayTimeDuration-set-equals",
            Self::YearMonthDurationIntersection => "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-intersection",
            Self::YearMonthDurationAtLeastOneMemberOf => "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-at-least-one-member-of",
            Self::YearMonthDurationUnion => "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-union",
            Self::YearMonthDurationSubset => "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-subset",
            Self::YearMonthDurationSetEquals => "urn:oasis:names:tc:xacml:3.0:function:yearMonthDuration-set-equals",
            Self::X500NameIntersection => "urn:oasis:names:tc:xacml:1.0:function:x500Name-intersection",
            Self::X500NameAtLeastOneMemberOf => "urn:oasis:names:tc:xacml:1.0:function:x500Name-at-least-one-member-of",
            Self::X500NameUnion => "urn:oasis:names:tc:xacml:1.0:function:x500Name-union",
            Self::X500NameSubset => "urn:oasis:names:tc:xacml:1.0:function:x500Name-subset",
            Self::X500NameSetEquals => "urn:oasis:names:tc:xacml:1.0:function:x500Name-set-equals",
            Self::Rfc822NameIntersection => "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-intersection",
            Self::Rfc822NameAtLeastOneMemberOf => "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-at-least-one-member-of",
            Self::Rfc822NameUnion => "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-union",
            Self::Rfc822NameSubset => "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-subset",
            Self::Rfc822NameSetEquals => "urn:oasis:names:tc:xacml:1.0:function:rfc822Name-set-equals",
            Self::AccessPermitted => "urn:oasis:names:tc:xacml:3.0:function:access-permitted",
        }
    }
}


impl Serialize for FunctionId {
    fn serialize<S>(&self, serializer: S) -> Result<S::Ok, S::Error>
    where
        S: Serializer,
    {
        serializer.serialize_str(self.to_xacml_id())
    }
}

impl<'de> Deserialize<'de> for FunctionId {
    fn deserialize<D>(deserializer: D) -> Result<Self, D::Error>
    where
        D: Deserializer<'de>,
    {
        let s: &str = Deserialize::deserialize(deserializer)?;
        FunctionId::from_str(s).map_err( |_| serde::de::Error::custom("invalid function URI"))
    }
}

mod test_function_id {
    #[cfg(test)]
    use super::*;
    use serde::{Serialize, Deserialize};
    #[allow(unused_imports)]
    use quick_xml::{se::to_string, de::from_str};
    
    #[derive(Serialize, Deserialize)]
    struct TestPolicy {
        #[serde(rename = "FunctionId")]
        pub function: super::FunctionId,
    }

    #[test]
    fn test_function_enum_to_str_mapping() {
        let function = FunctionId::StringEqual;
        assert_eq!(function.to_xacml_id(), "urn:oasis:names:tc:xacml:1.0:function:string-equal");
    }

    #[test]
    fn test_str_to_function_enum_mapping() {
        let function = FunctionId::from_str("urn:oasis:names:tc:xacml:1.0:function:string-equal").unwrap();
        assert_eq!(function, FunctionId::StringEqual);
    }

    #[test]
    fn test_serialize()
    {
        let policy: TestPolicy = TestPolicy {
            function: FunctionId::StringEqual,
        };
        let xml = to_string(&policy).unwrap();
        assert_eq!(xml, r#"<TestPolicy><FunctionId>urn:oasis:names:tc:xacml:1.0:function:string-equal</FunctionId></TestPolicy>"#);
    }
    
    #[test]
    fn test_deserialize()
    {
        let xml = r#"<TestPolicy><FunctionId>urn:oasis:names:tc:xacml:1.0:function:string-equal</FunctionId></TestPolicy>"#;
        let policy: TestPolicy = from_str(xml).unwrap();
        assert_eq!(policy.function, FunctionId::StringEqual);
    }

    #[test]
    fn test_invalid_xml_deserialization() {
        let xml = r#"<TestPolicy><FunctionId>urn:oasis:names:tc:xacml:1.0:function:unknown</FunctionId></TestPolicy>"#;
        let result: Result<TestPolicy, _> = from_str(xml);
        assert!(result.is_err());
    }

}